<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
<base href="http://zaccodes.com" />

	<meta charset="UTF-8" />
	<title>Done With Week 4 of Course 3 at Tealeaf Academy | Zac Clay</title>
			
	
	

		<!--[if lt IE 9]>
	<script src="http://zaccodes.com/wp-content/themes/Divi/js/html5.js" type="text/javascript"></script>
	<![endif]-->

	<script type="text/javascript">
		document.documentElement.className = 'js';
	</script>

	
<script type="text/javascript">var trackerAjaxUrl="http://zaccodes.com/wp-admin/admin-ajax.php";var trackerNonce="b854a7f160";</script>


<meta content="Zac Codes v.1.0.0" name="generator"/><link rel='stylesheet' id='jetpack-subscriptions-css'  href='http://zaccodes.com/wp-content/plugins/jetpack/modules/subscriptions/subscriptions.css?ver=3.9' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-css'  href='http://zaccodes.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=2.6.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-cg-cookie-css'  href='http://zaccodes.com/wp-content/plugins/crayon-syntax-highlighter/themes/cg-cookie/cg-cookie.css?ver=2.6.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='http://zaccodes.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=2.6.0' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-widgets-css'  href='http://zaccodes.com/wp-content/plugins/jetpack/modules/widgets/widgets.css?ver=20121003' type='text/css' media='all' />
<link rel='stylesheet' id='divi-fonts-css'  href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,800italic,400,300,700,800|Raleway:400,200,100,500,700,800,900&#038;subset=latin,latin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='et-gf-francois-one-css'  href='http://fonts.googleapis.com/css?family=Francois+One:400&#038;subset=latin,latin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='et-gf-source-sans-pro-css'  href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,200,200italic,300,300italic,400italic,600,600italic,700,700italic,900,900italic&#038;subset=latin,latin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='divi-style-css'  href='http://zaccodes.com/wp-content/themes/ZacCodes/style.css?ver=3.9' type='text/css' media='all' />
<link rel='stylesheet' id='et-shortcodes-css-css'  href='http://zaccodes.com/wp-content/themes/Divi/epanel/shortcodes/css/shortcodes.css?ver=3.0' type='text/css' media='all' />
<link rel='stylesheet' id='et-shortcodes-responsive-css-css'  href='http://zaccodes.com/wp-content/themes/Divi/epanel/shortcodes/css/shortcodes_responsive.css?ver=3.0' type='text/css' media='all' />
<script type='text/javascript' src='http://zaccodes.com/wp-includes/js/jquery/jquery.js?ver=1.11.0'></script>
<script type='text/javascript' src='http://zaccodes.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.6.0","is_admin":"0","ajaxurl":"http:\/\/zactealeaf.uni.me\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='http://zaccodes.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=2.6.0'></script>
<script type='text/javascript' src='http://zaccodes.com/wp-content/plugins/mainwp-child/js/tracker.js?ver=3.9'></script>

 

<link rel='next' title='Done With Week 5 of Course 3 at Tealeaf Academy' href='http://zaccodes.com/done-with-week-5-of-course-3-at-tealeaf-academy/' />

<link rel='canonical' href='http://zaccodes.com/done-with-week-4-of-course-3-at-tealeaf-academy/' />
<link rel='shortlink' href='http://wp.me/p4fXPV-nd' />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />	<style>
		a { color: #7EBEC5; }

		body { color: #666666; }

		.et_pb_counter_amount, .et_pb_featured_table .et_pb_pricing_heading, .et_pb_pricing_table_button, .comment-reply-link, .form-submit input { background-color: #7EBEC5; }

		.woocommerce a.button.alt, .woocommerce-page a.button.alt, .woocommerce button.button.alt, .woocommerce-page button.button.alt, .woocommerce input.button.alt, .woocommerce-page input.button.alt, .woocommerce #respond input#submit.alt, .woocommerce-page #respond input#submit.alt, .woocommerce #content input.button.alt, .woocommerce-page #content input.button.alt, .woocommerce a.button, .woocommerce-page a.button, .woocommerce button.button, .woocommerce-page button.button, .woocommerce input.button, .woocommerce-page input.button, .woocommerce #respond input#submit, .woocommerce-page #respond input#submit, .woocommerce #content input.button, .woocommerce-page #content input.button, .woocommerce-message, .woocommerce-error, .woocommerce-info { background: #7EBEC5 !important; }

		#et_search_icon:hover, .mobile_menu_bar:before, .footer-widget h4, .et-social-icon a:hover, .et_pb_sum, .et_pb_pricing li a, .et_overlay:before, .entry-summary p.price ins, .woocommerce div.product span.price, .woocommerce-page div.product span.price, .woocommerce #content div.product span.price, .woocommerce-page #content div.product span.price, .woocommerce div.product p.price, .woocommerce-page div.product p.price, .woocommerce #content div.product p.price, .woocommerce-page #content div.product p.price { color: #7EBEC5 !important; }

		.woocommerce .star-rating span:before, .woocommerce-page .star-rating span:before { color: #7EBEC5 !important; }

		.et-search-form, .nav li ul, .et_mobile_menu, .footer-widget li:before, .et_pb_pricing li:before { border-color: #7EBEC5; }

		#main-footer { background-color: #2e2e2e; }

		#top-menu a { color: #666666; }

		#top-menu li.current-menu-ancestor > a, #top-menu li.current-menu-item > a { color: #7CBEC6; }

	h1, h2, h3, h4, h5, h6 { font-family: 'Francois One', Helvetica, Arial, Lucida, sans-serif; }body, input, textarea, select { font-family: 'Source Sans Pro', Helvetica, Arial, Lucida, sans-serif; }	</style>

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Done With Week 4 of Course 3 at Tealeaf Academy" />
<meta property="og:url" content="http://zaccodes.com/done-with-week-4-of-course-3-at-tealeaf-academy/" />
<meta property="og:description" content="We covered a whole lot this week, I learned quite a few&hellip;" />
<meta property="article:published_time" content="2014-03-27T20:11:44+00:00" />
<meta property="article:modified_time" content="2014-03-27T20:18:31+00:00" />
<meta property="article:author" content="http://zaccodes.com/author/zac/" />
<meta property="og:site_name" content="Zac Clay" />
<meta property="og:image" content="http://wordpress.com/i/blank.jpg" />
<meta name="twitter:site" content="@jetpack" />
<meta name="twitter:card" content="summary" />
<style type="text/css" id="et-custom-css">
#top-menu a, .et_mobile_menu a, #et_search_icon:before {
    color: #ddd !important;
}
  
#top-menu a:hover, .et_mobile_menu a:hover {
    color: #fff !important;
}
  
.nav ul li a:hover, .et_mobile_menu li a:hover { color: #111; background-color: #2b2b2b; }
  
#top-menu li.mega-menu > ul > li > a:first-child, .et_mobile_menu li a {
    border-bottom: 1px solid #444;
}
  
#main-header, .et_mobile_menu, .nav li ul , #top-menu li.mega-menu > ul > li > a:first-child:hover, .et-search-form {
    background-color: #333 !important;
}
  
.et-search-form input {
    background-color: #2b2b2b;
    color: #999;
}
</style></head>
<body class="single single-post postid-1439 single-format-standard et_right_sidebar unknown et_includes_sidebar">
	<header id="main-header">
		<div class="container clearfix">
					<a href="http://zaccodes.com/">
				<img src="http://zaccodes.com/wp-content/uploads/2014/01/logozacthicker.png" alt="Zac Clay" id="logo" />
			</a>

			<div id="et-top-navigation">
				<nav id="top-menu">
				<ul id="top-menu" class="nav"><li id="menu-item-1554" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1554"><a href="http://zaccodes.com">Home</a></li>
<li id="menu-item-1550" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1550"><a href="http://zaccodes.com/contact/">Contact</a></li>
<li id="menu-item-1552" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1552"><a href="http://zaccodes.com/projects/">Projects</a></li>
<li id="menu-item-1553" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1553"><a href="http://zaccodes.com/blog/">Blog</a></li>
</ul>				</nav>

				

				<div id="et_mobile_nav_menu"><a href="#" class="mobile_nav closed"><span class="mobile_menu_bar"></span></a></div>			</div> <!-- #et-top-navigation -->
		</div> <!-- .container -->
	</header> <!-- #main-header -->
<div id="main-content">
	<div class="container">
		<div id="content-area" class="clearfix">
			<div id="left-area">
							
				<article id="post-1439" class="post-1439 post type-post status-publish format-standard hentry category-tealeaf category-updates et_pb_post">
					<h1>Done With Week 4 of Course 3 at Tealeaf Academy</h1>

				<p class="post-meta"> by <a href="http://zaccodes.com/author/zac/" title="Posts by Zac Clay" rel="author">Zac Clay</a> | Mar 27, 2014 | <a href="http://zaccodes.com/category/tealeaf/" title="View all posts in Tealeaf" rel="category tag">Tealeaf</a>, <a href="http://zaccodes.com/category/updates/" title="View all posts in Updates" rel="category tag">Updates</a> | </p>
					<div class="entry-content">
					<p>We covered a whole lot this week, I learned quite a few new things. A few things stood out however.</p>
<h3 id="testing-non-standard-models-with-shoulda-matchers-in-rspec">Testing non-standard models with Shoulda matchers in RSpec</h3>
<p>So this week we added some social networking features. We added the ability for users to follow other users. So one user is a follower and the other user is the leader in the way we set it up. To accomplish this we set up a <code>Relationship</code> model to keep track of these leader/follower relationships. This is what that model looks like:</p>
<p></p><!-- Crayon Syntax Highlighter v2.6.0 -->

		<div id="crayon-535a987d1ebdf054003781" class="crayon-syntax crayon-theme-cg-cookie crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 12px !important; line-height: 15px !important;">
class Relationship &amp;lt; ActiveRecord::Base
  belongs_to :follower, class_name: "User"
  belongs_to :leader, class_name: "User"

  validates_uniqueness_of :follower_id, scope: [:leader_id]
end 
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-535a987d1ebdf054003781-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-535a987d1ebdf054003781-2">2</div><div class="crayon-num" data-line="crayon-535a987d1ebdf054003781-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-535a987d1ebdf054003781-4">4</div><div class="crayon-num" data-line="crayon-535a987d1ebdf054003781-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-535a987d1ebdf054003781-6">6</div><div class="crayon-num" data-line="crayon-535a987d1ebdf054003781-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-535a987d1ebdf054003781-1"><span class="crayon-r">class</span><span class="crayon-h"> </span><span class="crayon-i">Relationship</span><span class="crayon-h"> </span><span class="crayon-v">&amp;lt</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">ActiveRecord</span><span class="crayon-o">::</span><span class="crayon-i">Base</span></div><div class="crayon-line crayon-striped-line" id="crayon-535a987d1ebdf054003781-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">belongs_to</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">follower</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">class</span><span class="crayon-sy">_</span>name<span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"User"</span></div><div class="crayon-line" id="crayon-535a987d1ebdf054003781-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">belongs_to</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">leader</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">class</span><span class="crayon-sy">_</span>name<span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"User"</span></div><div class="crayon-line crayon-striped-line" id="crayon-535a987d1ebdf054003781-4">&nbsp;</div><div class="crayon-line" id="crayon-535a987d1ebdf054003781-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">validates_uniqueness_of</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">follower_id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">scope</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-i">leader_id</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-535a987d1ebdf054003781-6"><span class="crayon-st">end</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-535a987d1ebdf054003781-7">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0054 seconds] -->
<p></p>
<p>The user model then needed these lines to get the connection set up:</p>
<p></p><!-- Crayon Syntax Highlighter v2.6.0 -->

		<div id="crayon-535a987d1ebee202442179" class="crayon-syntax crayon-theme-cg-cookie crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 12px !important; line-height: 15px !important;">
has_many :following_relationships, class_name: "Relationship", foreign_key: :follower_id
has_many :leading_relationships, class_name: "Relationship", foreign_key: :leader_id
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-535a987d1ebee202442179-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-535a987d1ebee202442179-2">2</div><div class="crayon-num" data-line="crayon-535a987d1ebee202442179-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-535a987d1ebee202442179-1"><span class="crayon-i">has_many</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">following_relationships</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">class</span><span class="crayon-sy">_</span>name<span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Relationship"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">foreign_key</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">follower_id</span></div><div class="crayon-line crayon-striped-line" id="crayon-535a987d1ebee202442179-2"><span class="crayon-i">has_many</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">leading_relationships</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">class</span><span class="crayon-sy">_</span>name<span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Relationship"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">foreign_key</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">leader_id</span></div><div class="crayon-line" id="crayon-535a987d1ebee202442179-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p></p>
<p>I had to dig around a bit in the excellent Shoulda <a href="https://github.com/thoughtbot/shoulda-matchers#readme">README</a> to figure out how to test these models that don&#8217;t really fit the default Rails behavior.</p>
<p>Here is my spec for the Relationships model</p>
<p></p><!-- Crayon Syntax Highlighter v2.6.0 -->

		<div id="crayon-535a987d1ebf5352934281" class="crayon-syntax crayon-theme-cg-cookie crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 12px !important; line-height: 15px !important;">
require 'spec_helper'

describe Relationship do
  it { should belong_to(:follower).class_name('User') }
  it { should belong_to(:leader).class_name('User') }
  it { should validate_uniqueness_of(:follower_id).scoped_to(:leader_id) }
end
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-535a987d1ebf5352934281-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-535a987d1ebf5352934281-2">2</div><div class="crayon-num" data-line="crayon-535a987d1ebf5352934281-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-535a987d1ebf5352934281-4">4</div><div class="crayon-num" data-line="crayon-535a987d1ebf5352934281-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-535a987d1ebf5352934281-6">6</div><div class="crayon-num" data-line="crayon-535a987d1ebf5352934281-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-535a987d1ebf5352934281-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-535a987d1ebf5352934281-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">'spec_helper'</span></div><div class="crayon-line crayon-striped-line" id="crayon-535a987d1ebf5352934281-2">&nbsp;</div><div class="crayon-line" id="crayon-535a987d1ebf5352934281-3"><span class="crayon-i">describe</span><span class="crayon-h"> </span><span class="crayon-i">Relationship</span><span class="crayon-h"> </span><span class="crayon-st">do</span></div><div class="crayon-line crayon-striped-line" id="crayon-535a987d1ebf5352934281-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">it</span><span class="crayon-h"> </span><span class="crayon-k ">{</span><span class="crayon-h"> </span><span class="crayon-i">should</span><span class="crayon-h"> </span><span class="crayon-e">belong_to</span><span class="crayon-sy">(</span><span class="crayon-o">:</span><span class="crayon-i">follower</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-r">class</span><span class="crayon-sy">_</span>name<span class="crayon-sy">(</span><span class="crayon-s">'User'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-k ">}</span></div><div class="crayon-line" id="crayon-535a987d1ebf5352934281-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">it</span><span class="crayon-h"> </span><span class="crayon-k ">{</span><span class="crayon-h"> </span><span class="crayon-i">should</span><span class="crayon-h"> </span><span class="crayon-e">belong_to</span><span class="crayon-sy">(</span><span class="crayon-o">:</span><span class="crayon-i">leader</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-r">class</span><span class="crayon-sy">_</span>name<span class="crayon-sy">(</span><span class="crayon-s">'User'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-k ">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-535a987d1ebf5352934281-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">it</span><span class="crayon-h"> </span><span class="crayon-k ">{</span><span class="crayon-h"> </span><span class="crayon-i">should</span><span class="crayon-h"> </span><span class="crayon-e">validate_uniqueness_of</span><span class="crayon-sy">(</span><span class="crayon-o">:</span><span class="crayon-i">follower_id</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">scoped_to</span><span class="crayon-sy">(</span><span class="crayon-o">:</span><span class="crayon-i">leader_id</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-k ">}</span></div><div class="crayon-line" id="crayon-535a987d1ebf5352934281-7"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-535a987d1ebf5352934281-8">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0029 seconds] -->
<p></p>
<p>And the relevant parts of my User Model spec:</p>
<p></p><!-- Crayon Syntax Highlighter v2.6.0 -->

		<div id="crayon-535a987d1ebfb826547279" class="crayon-syntax crayon-theme-cg-cookie crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 12px !important; line-height: 15px !important;">
it { should have_many(:following_relationships).class_name("Relationship").with_foreign_key('follower_id') }
it { should have_many(:leading_relationships).class_name("Relationship").with_foreign_key('leader_id') }
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-535a987d1ebfb826547279-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-535a987d1ebfb826547279-2">2</div><div class="crayon-num" data-line="crayon-535a987d1ebfb826547279-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-535a987d1ebfb826547279-1"><span class="crayon-i">it</span><span class="crayon-h"> </span><span class="crayon-k ">{</span><span class="crayon-h"> </span><span class="crayon-i">should</span><span class="crayon-h"> </span><span class="crayon-e">have_many</span><span class="crayon-sy">(</span><span class="crayon-o">:</span><span class="crayon-i">following_relationships</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-r">class</span><span class="crayon-sy">_</span>name<span class="crayon-sy">(</span><span class="crayon-s">"Relationship"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">with_foreign_key</span><span class="crayon-sy">(</span><span class="crayon-s">'follower_id'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-k ">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-535a987d1ebfb826547279-2"><span class="crayon-i">it</span><span class="crayon-h"> </span><span class="crayon-k ">{</span><span class="crayon-h"> </span><span class="crayon-i">should</span><span class="crayon-h"> </span><span class="crayon-e">have_many</span><span class="crayon-sy">(</span><span class="crayon-o">:</span><span class="crayon-i">leading_relationships</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-r">class</span><span class="crayon-sy">_</span>name<span class="crayon-sy">(</span><span class="crayon-s">"Relationship"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">with_foreign_key</span><span class="crayon-sy">(</span><span class="crayon-s">'leader_id'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-k ">}</span></div><div class="crayon-line" id="crayon-535a987d1ebfb826547279-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p></p>
<p>So, this week really got me to dive deeper into Rails models. How they work, and how to properly test them.</p>
<h3 id="set-host-in-test-environment-config-for-mail-tests">Set host in test environment config for mail tests</h3>
<p>This week we also got introduced to mailers and how to test them. Most of it was straight-forward. However, a source of frustration for me involved urls in the email view templates.</p>
<p>In order to point a link in an email to your site, you have to specify the host. The way we did this in our development environment was to add this line to the config/environments/development.rb file:</p>
<p></p><!-- Crayon Syntax Highlighter v2.6.0 -->

		<div id="crayon-535a987d1ec02220135561" class="crayon-syntax crayon-theme-cg-cookie crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 12px !important; line-height: 15px !important;">
config.action_mailer.default_url_options = { host: 'localhost:3000' }
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-535a987d1ec02220135561-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-535a987d1ec02220135561-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-535a987d1ec02220135561-1"><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">action_mailer</span><span class="crayon-sy">.</span><span class="crayon-r">def</span><span class="crayon-v">ault_url_options</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">{</span><span class="crayon-h"> </span><span class="crayon-i">host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'localhost:3000'</span><span class="crayon-h"> </span><span class="crayon-k ">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-535a987d1ec02220135561-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p></p>
<p>That works great for playing around with the UI, but when I was trying to run tests I kept getting errors telling me to specify a host. The problem is that you need to add that line to the config/environments/test.rb file as well. This is pretty obvious looking back, but it took me a little while to figure that out, so if anyone else runs into that issue, that&#8217;s how you fix it :).</p>
<h3 id="resetting-the-password">Resetting the password</h3>
<p>This week we also learned how to implement a pretty advanced feature, allowing the user to reset their password. It was really awesome to learn how to implement something like this. Everyday I am getting more and more confident in my ability to build a full-fledged production-quality app.</p>
					</div> <!-- .entry-content -->

					
					
<div id="disqus_thread">
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://zaccodes.com/done-with-week-4-of-course-3-at-tealeaf-academy/';
    var disqus_identifier = '1439 http://zaccodes.com/?p=1439';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'zacgithub';
    var disqus_title = "Done With Week 4 of Course 3 at Tealeaf Academy";
        var disqus_config = function () {
        var config = this; // Access to the config object
        config.language = '';

        /*
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            var script = document.createElement('script');
            script.async = true;
            script.src = '?cf_action=sync_comments&post_id=1439';

            var firstScript = document.getElementsByTagName( "script" )[0];
            firstScript.parentNode.insertBefore(script, firstScript);
        });
                    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/zactealeaf.uni.me\/done-with-week-4-of-course-3-at-tealeaf-academy\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.' + 'disqus.com' + '/embed.js?pname=wordpress&pver=2.74';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>
				</article> <!-- .et_pb_post -->

										</div> <!-- #left-area -->

				<div id="sidebar">
		<div id="twitter_timeline-3" class="et_pb_widget widget_twitter_timeline"><a class="twitter-timeline" data-widget-id="458957731198541824" data-theme="dark" data-link-color="#f96e5b" data-border-color="#e8e8e8" data-tweet-limit="3" width="289" height="215" lang="EN">My Tweets</a></div> <!-- end .et_pb_widget -->		<div id="recent-posts-2" class="et_pb_widget widget_recent_entries">		<h4 class="widgettitle">Recent Posts</h4>		<ul>
					<li>
				<a href="http://zaccodes.com/tealeaf-academy-review/">Tealeaf Academy Review</a>
						</li>
					<li>
				<a href="http://zaccodes.com/how-to-seed-file-uploads-from-a-remote-url-for-carrierwave/">How to seed file uploads from a remote URL for CarrierWave.</a>
						</li>
					<li>
				<a href="http://zaccodes.com/completely-done-with-tealeaf-academy/">Completely Done With Tealeaf Academy!</a>
						</li>
					<li>
				<a href="http://zaccodes.com/done-with-week-7-of-course-3-at-tealeaf-academy/">Done With Week 7 of Course 3 at Tealeaf Academy</a>
						</li>
					<li>
				<a href="http://zaccodes.com/done-with-week-6-of-course-3-at-tealeaf-academy/">Done With Week 6 of Course 3 at Tealeaf Academy</a>
						</li>
				</ul>
		</div> <!-- end .et_pb_widget -->	</div> <!-- end #sidebar -->
		</div> <!-- #content-area -->
	</div> <!-- .container -->
</div> <!-- #main-content -->

	<footer id="main-footer">
		
		<div id="footer-bottom">
			<div class="container clearfix">
				<ul id="et-social-icons">
													<li class="et-social-icon et-social-twitter">
						<a href="http://twitter.com/mebezac">
							<span>Twitter</span>
						</a>
					</li>
																</ul>

				<p id="footer-info">Copyright 2014 <a href = "http://zaccodes.com"><strong>Zac Clay</strong></a></p>
			</div>	<!-- .container -->
		</div>
	</footer> <!-- #main-footer -->

		<div style="display:none">
	</div>
<script type='text/javascript' src='//platform.twitter.com/widgets.js?ver=3.9'></script>
<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201417'></script>
<script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?ver=2014Apraa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='http://zaccodes.com/wp-content/plugins/jetpack/modules/wpgroho.js?ver=3.9'></script>
<script type='text/javascript' src='http://zaccodes.com/wp-includes/js/comment-reply.min.js?ver=3.9'></script>
<script type='text/javascript' src='http://zaccodes.com/wp-content/themes/Divi/js/jquery.fitvids.js?ver=1.0'></script>
<script type='text/javascript' src='http://zaccodes.com/wp-content/themes/Divi/js/waypoints.min.js?ver=1.0'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var et_custom = {"ajaxurl":"http:\/\/zactealeaf.uni.me\/wp-admin\/admin-ajax.php","et_load_nonce":"0bc41fbfa2","subscription_failed":"Please, check the fields below to make sure you entered the correct information.","fill":"Fill","field":"field","invalid":"Invalid email","captcha":"Captcha"};
/* ]]> */
</script>
<script type='text/javascript' src='http://zaccodes.com/wp-content/themes/Divi/js/custom.js?ver=1.0'></script>

	<script src="http://stats.wordpress.com/e-201417.js" type="text/javascript"></script>
	<script type="text/javascript">
	st_go({v:'ext',j:'1:2.9.3',blog:'62910279',post:'1439',tz:'-4'});
	var load_cmc = function(){linktracker_init(62910279,1439,2);};
	if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
	else load_cmc();
	</script></body>
</html>